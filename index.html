<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
    <title>Neon Snake - New skins</title>
    
    <style>
        :root {
            --bg: #050505;
            --primary: #00ffcc;
            --text: #ffffff;
            --ui-bg: rgba(0, 0, 0, 0.95);
        }

        html, body { height: 100%; margin: 0; overflow: hidden; background: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; display: flex; flex-direction: column; user-select: none; }
        header { padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; background: #0a0a0a; border-bottom: 1px solid #222; }
        h1 { font-size: 20px; margin: 0; color: var(--primary); text-shadow: 0 0 10px var(--primary); }
        .stats { font-family: monospace; font-size: 16px; color: #888; }
        #score, #high { color: #fff; }

        #game-container { flex: 1; position: relative; display: flex; justify-content: center; align-items: center; padding: 10px; }
        
        /* The Classic Death Animation */
        canvas { background: #000; border: 5px solid #fff; border-radius: 4px; box-shadow: 0 0 15px rgba(255, 255, 255, 0.3); transition: border-color 0.2s; }
        canvas.death-pulse { animation: flashWhite 0.6s ease-out; }
        @keyframes flashWhite {
            0% { border-color: #fff; box-shadow: 0 0 50px #fff; transform: scale(1.02); }
            100% { border-color: #fff; box-shadow: 0 0 15px rgba(255,255,255,0.3); transform: scale(1); }
        }

        #ui-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; background: rgba(0,0,0,0.85); backdrop-filter: blur(8px); z-index: 20; transition: opacity 0.3s; }
        #ui-layer.hidden { opacity: 0; pointer-events: none; }
        
        .menu-box { text-align: center; background: var(--ui-bg); padding: 30px; border: 1px solid #333; border-radius: 20px; width: 320px; }
        .menu-title { font-size: 28px; font-weight: 900; color: var(--primary); margin-bottom: 15px; }
        
        .btn { background: var(--primary); color: #000; border: none; padding: 14px; font-size: 18px; font-weight: 800; border-radius: 10px; cursor: pointer; width: 100%; margin-top: 15px; }
        .shop-btn { background: #111; color: #fff; border: 1px solid #333; padding: 12px; width: 100%; margin-top: 10px; cursor: pointer; border-radius: 8px; display: flex; justify-content: space-between; }
        .shop-content { max-height: 0; overflow: hidden; transition: 0.4s; background: #000; }
        .shop-content.open { max-height: 300px; padding: 10px 0; border: 1px solid #333; border-top: none; }
        
        .skin-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; padding: 5px; }
        .skin-card { background: #0a0a0a; border: 1px solid #222; padding: 10px; border-radius: 6px; cursor: pointer; font-size: 11px; }
        .skin-card.selected { border-color: var(--primary); background: rgba(0, 255, 204, 0.1); }
        .swatch { width: 14px; height: 14px; margin: 0 auto 5px; border-radius: 3px; }
        
        footer { padding: 10px; text-align: center; font-size: 12px; color: #444; }
    </style>
</head>
<body>
    <header>
        <h1>NEON SNAKE</h1>
        <div class="stats">SCORE: <span id="score">0</span> &nbsp;|&nbsp; BEST: <span id="high">0</span></div>
    </header>

    <div id="game-container">
        <canvas id="c"></canvas>
        <div id="ui-layer">
            <div class="menu-box">
                <div class="menu-title" id="menu-text">READY?</div>
                <button class="shop-btn" onclick="toggleShop('snake-shop')">SNAKE SKINS <span>â–¼</span></button>
                <div id="snake-shop" class="shop-content"><div class="skin-grid" id="snake-grid"></div></div>
                <button class="btn" id="start-btn">START GAME</button>
            </div>
        </div>
    </div>
    <footer>HAPPY BIRTHDAY SANJIT</footer>

<script>
    const SNAKE_SKINS = [
        { id: 's1', name: 'NEON', head: '#00ffcc', body: '#00bfa5' },
        { id: 'svoid', name: 'VOID', head: '#000000', body: '#000000' }
    ];

    const state = {
        snake: [], dir: {x:1, y:0}, lastD: {x:1, y:0},
        food: {x:0, y:0}, score: 0, 
        wallet: parseInt(localStorage.getItem('neon_best') || '0'),
        activeSnake: SNAKE_SKINS[0],
        gameOver: true, eyeFlash: 0
    };

    const canvas = document.getElementById('c');
    const ctx = canvas.getContext('2d');
    const CONFIG = { cols: 31, rows: 15, cellSize: 25 };

    function toggleShop(id) { document.getElementById(id).classList.toggle('open'); }

    function renderShops() {
        document.getElementById('high').textContent = state.wallet;
        const sGrid = document.getElementById('snake-grid'); sGrid.innerHTML = '';
        SNAKE_SKINS.forEach(skin => {
            const isSel = state.activeSnake.id === skin.id;
            const card = document.createElement('div');
            card.className = `skin-card ${isSel ? 'selected' : ''}`;
            card.innerHTML = `<div class="swatch" style="background:${skin.head}; border:1px solid #333"></div><b>${skin.name}</b>`;
            card.onclick = () => { state.activeSnake = skin; renderShops(); };
            sGrid.appendChild(card);
        });
    }

    function spawnFood() {
        state.food = { x: Math.floor(Math.random()*CONFIG.cols), y: Math.floor(Math.random()*CONFIG.rows) };
        if (state.snake.some(p => p.x === state.food.x && p.y === state.food.y)) spawnFood();
    }

    function startGame() {
        state.snake = [{x:8, y:7}, {x:7, y:7}, {x:6, y:7}];
        state.dir = {x:1, y:0}; state.lastD = {x:1, y:0};
        state.score = 0; state.eyeFlash = 0;
        document.getElementById('score').textContent = '0';
        canvas.className = ""; spawnFood(); state.gameOver = false;
        document.getElementById('ui-layer').classList.add('hidden');
        requestAnimationFrame(loop);
    }

    function update() {
        const head = { x: state.snake[0].x + state.dir.x, y: state.snake[0].y + state.dir.y };
        
        if (head.x < 0 || head.x >= CONFIG.cols || head.y < 0 || head.y >= CONFIG.rows || state.snake.some(p => p.x === head.x && p.y === head.y)) {
            state.gameOver = true;
            canvas.classList.add('death-pulse');
            if (state.score > state.wallet) state.wallet = state.score;
            localStorage.setItem('neon_best', state.wallet);
            setTimeout(() => { 
                document.getElementById('menu-text').textContent = "CRASHED!";
                document.getElementById('ui-layer').classList.remove('hidden'); 
                renderShops();
            }, 600);
            return;
        }

        state.snake.unshift(head);
        if (head.x === state.food.x && head.y === state.food.y) {
            state.score++; document.getElementById('score').textContent = state.score;
            if(state.activeSnake.id === 'svoid') state.eyeFlash = 1.0;
            spawnFood();
        } else state.snake.pop();

        if(state.eyeFlash > 0) state.eyeFlash -= 0.05;
        state.lastD = state.dir;
    }

    function render() {
        ctx.fillStyle = '#000'; ctx.fillRect(0,0,canvas.width,canvas.height);
        
        // Food
        ctx.fillStyle = '#f00'; ctx.beginPath();
        ctx.arc(state.food.x*25+12.5, state.food.y*25+12.5, 8, 0, Math.PI*2); ctx.fill();

        // Snake
        state.snake.forEach((seg, i) => {
            ctx.fillStyle = (i === 0) ? state.activeSnake.head : state.activeSnake.body;
            const x = seg.x * 25; const y = seg.y * 25;
            
            if(state.activeSnake.id === 'svoid') {
                ctx.strokeStyle = '#333'; ctx.lineWidth = 1;
                ctx.fillRect(x+1, y+1, 23, 23); ctx.strokeRect(x+1, y+1, 23, 23);
            } else {
                ctx.fillRect(x+1, y+1, 23, 23);
            }

            // Eyes logic for VOID skin
            if(i === 0) {
                let eyeColor = (state.activeSnake.head === '#000000') ? '#fff' : '#000';
                if(state.activeSnake.id === 'svoid') {
                    const gb = Math.floor(255 * (1 - state.eyeFlash));
                    eyeColor = `rgb(255, ${gb}, ${gb})`; 
                    if(state.eyeFlash > 0) { ctx.shadowBlur = 10; ctx.shadowColor = '#f00'; }
                }
                ctx.fillStyle = eyeColor;
                // Simple eye positioning based on direction
                let ex = x+15, ey1 = y+5, ey2 = y+15;
                if(state.lastD.x === -1) ex = x+5;
                if(state.lastD.y !== 0) { ex = x+5; let ex2 = x+15; ey1 = ey2 = (state.lastD.y === 1) ? y+15 : y+5; ctx.fillRect(ex, ey1, 4, 4); ctx.fillRect(ex2, ey1, 4, 4); }
                else { ctx.fillRect(ex, ey1, 4, 4); ctx.fillRect(ex, ey2, 4, 4); }
                ctx.shadowBlur = 0;
            }
        });
    }

    function loop() {
        if(state.gameOver) { render(); return; }
        update(); render();
        setTimeout(() => requestAnimationFrame(loop), 100);
    }

    canvas.width = CONFIG.cols * 25; canvas.height = CONFIG.rows * 25;
    document.getElementById('start-btn').onclick = startGame;
    window.addEventListener('keydown', e => {
        const k = e.key.toLowerCase();
        if(k === 'w' && state.lastD.y === 0) state.dir = {x:0, y:-1};
        if(k === 's' && state.lastD.y === 0) state.dir = {x:0, y:1};
        if(k === 'a' && state.lastD.x === 0) state.dir = {x:-1, y:0};
        if(k === 'd' && state.lastD.x === 0) state.dir = {x:1, y:0};
        if((k === ' ' || k === 'r') && state.gameOver) startGame();
    });
    renderShops();
</script>
</body>
</html>
